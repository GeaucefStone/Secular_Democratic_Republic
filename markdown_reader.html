<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Markdown Reader</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #000000;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: #1a365d;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        #fileInput {
            display: none;
        }
        .browse-btn {
            background: #007cba;
            border: none;
            border-radius: 5px;
            display: block;
            padding: 20px;
            font-size: 18px;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            margin-bottom: 10px;
            width: 100%;
        }
        .browse-btn:hover {
            background: #005a87;
        }
        #markdown-output {
            line-height: 1.6;
            padding: 20px;
            background: #fafafa;
            border-radius: 5px;
            min-height: 200px;
            margin-top: 20px;
        }
        .instructions {
            background: #2d3748;
            border: 1px solid #4a5568;
            border-radius: 5px;
            color: #e2e8f0;
            margin-bottom: 20px;
            padding: 15px;
            text-align: center;
        }
        .folder-hint {
            color: #d63031;
            font-size: 14px;
            font-weight: bold;
            margin: 10px 0;
            text-align: center;
        }
        .current-file {
            background: #2d3748;
            border: 1px solid #4a5568;
            border-radius: 5px;
            color: #007cba;
            font-weight: bold;
            margin: 15px 0;
            padding: 10px;
            text-align: center;
        }
        #markdown-output table {
            border-collapse: collapse;
            width: 100%;
            margin: 15px 0;
        }
        #markdown-output th, #markdown-output td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            text-align: left;
        }
        #markdown-output th {
            background: #2d3748;
            color: white;
        }
        #markdown-output blockquote {
            border-left: 4px solid #000;
            font-style: italic;
            margin: 15px 0;
            padding: 10px 20px;
        }
        #markdown-output hr {
            border: 0;
            background: #ddd;
            height: 1px;
            margin: 20px 0;
}
    </style>
</head>
<body>
    <div class="container">
        <h1 style="color: white;">üìÑ Markdown Reader</h1>
        
        <div class="instructions">
            <p><strong>Tip:</strong> Your Markdown files are within the same folder as this HTML file.</p>
            <p>When the file dialog opens, navigate to this folder to find your files quickly.</p>
            <p><strong>Supported:</strong> .md, .markdown, .txt files</p>
            <p><strong>Shortcut:</strong> Ctrl+O to open files quickly</p>
        </div>

        <button class="browse-btn" onclick="document.getElementById('fileInput').click()">
            üìÅ Open Markdown File
        </button>
        <input type="file" id="fileInput" accept=".md,.markdown,.txt">

        <div class="folder-hint" id="folderHint">
            üí° Look for the folder containing this HTML file
        </div>

        <div id="currentFile" class="current-file"></div>

        <div id="markdown-output">
            <p style="text-align: center; color: #999;">
                Select a Markdown file to view its formatted content.
            </p>
        </div>
    </div>


<script>
// Focus on bold, italic (underscores only), and links
function processBold(text) {
    return text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
}

function processItalic(text) {
    // Use underscores only for italics - won't conflict with bullets
    return text.replace(/_(.*?)_/g, '<em>$1</em>');
}

function processLinks(text) {
    return text.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank">$1</a>');
}

// Main function that applies processing in correct order
function processInlineMarkdown(text) {
    return processLinks(processItalic(processBold(text)));
}

function parseMarkdown(md) {
    let inSolidList = false;
    let inHollowList = false;
    let lines = md.split('\n');
    let result = [];
    
    for (let i = 0; i < lines.length; i++) {
        let line = lines[i];
        
        // Check for solid bullet list item (-)
        if (line.trim().startsWith('- ')) {
            if (!inSolidList) {
                result.push('<ul style="list-style-type: disc;">'); // Solid bullet
                inSolidList = true;
            }
            // Process inline markdown for list items
            let listContent = processInlineMarkdown(line.trim().substring(2));
            result.push('<li>' + listContent + '</li>');
        } 
        // Check for hollow bullet list item (*)
        else if (line.trim().startsWith('* ')) {
            if (!inHollowList) {
                result.push('<ul style="list-style-type: circle;">'); // Hollow bullet
                inHollowList = true;
            }
            // Process inline markdown for list items
            let listContent = processInlineMarkdown(line.trim().substring(2));
            result.push('<li>' + listContent + '</li>');
        } 
        else {
            // Close any open lists
            if (inSolidList) {
                result.push('</ul>');
                inSolidList = false;
            }
            if (inHollowList) {
                result.push('</ul>');
                inHollowList = false;
            }
            
            // Process non-list lines
            if (line.trim()) {
                let processedLine = line.trim();
                
                // Handle block elements first
                if (processedLine.startsWith('> ')) {
                    processedLine = '<blockquote>' + processInlineMarkdown(processedLine.substring(2)) + '</blockquote>';
                } else if (processedLine.startsWith('# ')) {
                    processedLine = '<h1>' + processInlineMarkdown(processedLine.substring(2)) + '</h1>';
                } else if (processedLine.startsWith('## ')) {
                    processedLine = '<h2>' + processInlineMarkdown(processedLine.substring(3)) + '</h2>';
                } else if (processedLine.startsWith('### ')) {
                    processedLine = '<h3>' + processInlineMarkdown(processedLine.substring(4)) + '</h3>';
                } else if (processedLine.startsWith('#### ')) {
                    processedLine = '<h4>' + processInlineMarkdown(processedLine.substring(5)) + '</h4>';
                } else if (processedLine.startsWith('##### ')) {
                    processedLine = '<h5>' + processInlineMarkdown(processedLine.substring(6)) + '</h5>';
                } else if (processedLine.startsWith('###### ')) {
                    processedLine = '<h6>' + processInlineMarkdown(processedLine.substring(7)) + '</h6>';
                } else if (processedLine === '---') {
                    processedLine = '<hr>';
                } else {
                    // Regular paragraph
                    processedLine = '<p>' + processInlineMarkdown(processedLine) + '</p>';
                }
                
                result.push(processedLine);
            }
        }
    }
    
    // Close any open lists
    if (inSolidList) {
        result.push('</ul>');
    }
    if (inHollowList) {
        result.push('</ul>');
    }
    
    return result.join('\n');
}

// Event listeners and variables
const fileInput = document.getElementById('fileInput');
const output = document.getElementById('markdown-output');
const currentFile = document.getElementById('currentFile');
const folderHint = document.getElementById('folderHint');

fileInput.addEventListener('change', (event) => {
    const file = event.target.files[0];
    if (!file) {
        output.innerHTML = '<p style="text-align: center; color: #999;">Select a Markdown file to view its content.</p>';
        currentFile.textContent = '';
        return;
    }

    // Show which file is currently open
    currentFile.textContent = `Viewing: ${file.name}`;
    folderHint.style.display = 'none';

    const reader = new FileReader();
    reader.onload = (e) => {
        output.innerHTML = parseMarkdown(e.target.result);
    };
    reader.onerror = () => {
        output.innerHTML = '<p style="color: red;">Error reading file</p>';
        currentFile.textContent = '';
    };
    reader.readAsText(file);
});

// Auto-focus the button for keyboard accessibility
window.addEventListener('load', function() {
    document.querySelector('.browse-btn').focus();
});

document.addEventListener('keydown', (e) => {
    if ((e.ctrlKey || e.metaKey) && e.key === 'o') {
        e.preventDefault();
        document.getElementById('fileInput').click();
    }
});
</script>


</body>
</html>